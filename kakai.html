<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario com Tabela e Excel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .form-container {
            margin-bottom: 20px;
        }
        .form-container input, .form-container select, .form-container textarea {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .button-container {
            margin-top: 10px;
        }
        .buttons {
            display: inline-block;
            padding: 10px;
            margin-right: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .buttons:hover {
            background-color: #45a049;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
    </style>
</head>
<body>

    <h1>Formulário de Operação</h1>

    <div id="forms-container">
        <div class="form-container">
            <label for="categoria">Categoria:</label>
            <input type="text" id="categoria" name="categoria">
            <label for="nomeEmpresa">Nome da Empresa:</label>
            <input type="text" id="nomeEmpresa" name="nomeEmpresa">
            <label for="data">Data:</label>
            <input type="date" id="data" name="data">
            <label for="hora">Hora:</label>
            <input type="time" id="hora" name="hora">
            <label for="origem">Origem:</label>
            <input type="text" id="origem" name="origem">
            <label for="destino">Destino:</label>
            <input type="text" id="destino" name="destino">
            <label for="local">Local:</label>
            <input type="text" id="local" name="local">

            <label for="motorista">Motorista:</label>
            <input type="text" id="motorista" name="motorista">
            <label for="telefoneMotorista">Telefone:</label>
            <input type="text" id="telefoneMotorista" name="telefoneMotorista">
            <label for="placaCavalo">Placa do Cavalo:</label>
            <input type="text" id="placaCavalo" name="placaCavalo">
            <label for="placaCarreta">Placa da Carreta:</label>
            <input type="text" id="placaCarreta" name="placaCarreta">
            <label for="motivo">Motivo:</label>
            <input type="text" id="motivo" name="motivo">
            <label for="transportadora">Transportadora:</label>
            <input type="text" id="transportadora" name="transportadora">

            <label for="valorPedagio">Valor do Pedágio:</label>
            <input type="number" id="valorPedagio" name="valorPedagio">
            <label for="kmInicial">Km Inicial:</label>
            <input type="number" id="kmInicial" name="kmInicial">
            <label for="kmFinal">Km Final:</label>
            <input type="number" id="kmFinal" name="kmFinal">
            <label for="totalKm">Total de Km:</label>
            <input type="number" id="totalKm" name="totalKm">
            <label for="horarioLocal">Horário Local do Agente:</label>
            <input type="time" id="horarioLocal" name="horarioLocal">
            <label for="horarioInicio">Horário de Início da Operação:</label>
            <input type="time" id="horarioInicio" name="horarioInicio">
            <label for="horarioTermino">Horário de Término da Operação:</label>
            <input type="time" id="horarioTermino" name="horarioTermino">
            <label for="totalHorasOperacao">Total de Horas da Operação:</label>
            <input type="number" id="totalHorasOperacao" name="totalHorasOperacao">
            <label for="totalHorasAgente">Total de Horas do Agente:</label>
            <input type="number" id="totalHorasAgente" name="totalHorasAgente">

            <label for="manifesto">Manifesto:</label>
            <textarea id="manifesto" name="manifesto"></textarea>

            <div class="button-container">
                <button class="buttons" onclick="addEntry()">Adicionar Nova Entrada</button>
                <button class="buttons" onclick="generateTable()">Gerar Tabela</button>
                <button class="buttons" onclick="copyToClipboard()">Copiar Tabela</button>
            </div>
        </div>
    </div>

    <table id="table" style="display: none;">
        <thead>
            <tr>
                <th>Categoria</th>
                <th>Nome da Empresa</th>
                <th>Data</th>
                <th>Hora</th>
                <th>Origem</th>
                <th>Destino</th>
                <th>Local</th>
                <th>Motorista</th>
                <th>Telefone</th>
                <th>Placa do Cavalo</th>
                <th>Placa da Carreta</th>
                <th>Motivo</th>
                <th>Transportadora</th>
                <th>Valor do Pedágio</th>
                <th>Km Inicial</th>
                <th>Km Final</th>
                <th>Total de Km</th>
                <th>Horário Local do Agente</th>
                <th>Horário de Início</th>
                <th>Horário de Término</th>
                <th>Total de Horas da Operação</th>
                <th>Total de Horas do Agente</th>
                <th>Manifesto</th>
            </tr>
        </thead>
        <tbody id="table-body">
        </tbody>
    </table>

    <script>
        let entries = [];

        function addEntry() {
            const entry = {
                categoria: document.getElementById('categoria').value,
                nomeEmpresa: document.getElementById('nomeEmpresa').value,
                data: document.getElementById('data').value,
                hora: document.getElementById('hora').value,
                origem: document.getElementById('origem').value,
                destino: document.getElementById('destino').value,
                local: document.getElementById('local').value,
                motorista: document.getElementById('motorista').value,
                telefoneMotorista: document.getElementById('telefoneMotorista').value,
                placaCavalo: document.getElementById('placaCavalo').value,
                placaCarreta: document.getElementById('placaCarreta').value,
                motivo: document.getElementById('motivo').value,
                transportadora: document.getElementById('transportadora').value,
                valorPedagio: document.getElementById('valorPedagio').value,
                kmInicial: document.getElementById('kmInicial').value,
                kmFinal: document.getElementById('kmFinal').value,
                totalKm: document.getElementById('totalKm').value,
                horarioLocal: document.getElementById('horarioLocal').value,
                horarioInicio: document.getElementById('horarioInicio').value,
                horarioTermino: document.getElementById('horarioTermino').value,
                totalHorasOperacao: document.getElementById('totalHorasOperacao').value,
                totalHorasAgente: document.getElementById('totalHorasAgente').value,
                manifesto: document.getElementById('manifesto').value,
            };

            entries.push(entry);
            resetForm();
        }

        function resetForm() {
            document.getElementById('categoria').value = '';
            document.getElementById('nomeEmpresa').value = '';
            document.getElementById('data').value = '';
            document.getElementById('hora').value = '';
            document.getElementById('origem').value = '';
            document.getElementById('destino').value = '';
            document.getElementById('local').value = '';
            document.getElementById('motorista').value = '';
            document.getElementById('telefoneMotorista').value = '';
            document.getElementById('placaCavalo').value = '';
            document.getElementById('placaCarreta').value = '';
            document.getElementById('motivo').value = '';
            document.getElementById('transportadora').value = '';
            document.getElementById('valorPedagio').value = '';
            document.getElementById('kmInicial').value = '';
            document.getElementById('kmFinal').value = '';
            document.getElementById('totalKm').value = '';
            document.getElementById('horarioLocal').value = '';
            document.getElementById('horarioInicio').value = '';
            document.getElementById('horarioTermino').value = '';
            document.getElementById('totalHorasOperacao').value = '';
            document.getElementById('totalHorasAgente').value = '';
            document.getElementById('manifesto').value = '';
        }

        function generateTable() {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = '';

            entries.forEach(entry => {
                const row = document.createElement('tr');
                Object.values(entry).forEach(value => {
                    const cell = document.createElement('td');
                    cell.textContent = value;
                    row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });

            document.getElementById('table').style.display = 'table';
        }

        function copyToClipboard() {
            const table = document.getElementById('table');
            const range = document.createRange();
            range.selectNode(table);
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            alert('Tabela copiada para a área de transferência!');
        }
    </script>

</body>
</html>
