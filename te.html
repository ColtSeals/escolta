<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entrada e Copiar Dados para Excel</title>
    <!-- Link para o Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <h2>Inserir Dados</h2>
        <!-- Formulário de Input -->
        <div class="mb-3">
            <label for="inputTexto" class="form-label">Insira o texto abaixo</label>
            <textarea class="form-control" id="inputTexto" rows="10"></textarea>
        </div>
        <button class="btn btn-primary" onclick="processarTexto()">Processar Dados</button>

        <!-- Tabela com os dados processados -->
        <h3 class="mt-5">Tabela de Dados Processados</h3>
        <table class="table table-bordered" id="tabelaDados">
            <thead>
                <tr>
                    <th>Modalidade</th>
                    <th>Empresa</th>
                    <th>Origem</th>
                    <th>Destino</th>
                    <th>Data</th>
                    <th>Hora</th>
                    <th>Motorista</th>
                    <th>Placa</th>
                    <th>Telefone</th>
                    <th>Agente</th>
                    <th>Telefone do Agente</th>
                    <th>Veículo Utilizado</th>
                    <th>Placa do Veículo</th>
                    <th>Valor do Pedágio</th>
                    <th>Km Inicial</th>
                    <th>Km Final</th>
                    <th>Total de Km</th>
                    <th>Horário Local do Agente</th>
                    <th>Horário de Início</th>
                    <th>Horário de Término</th>
                    <th>Total de Horas da Operação</th>
                    <th>Total de Horas do Agente</th>
                </tr>
            </thead>
            <tbody id="tbodyTabela">
                <!-- Linhas de dados serão inseridas aqui -->
            </tbody>
        </table>
        <button class="btn btn-success mt-3" onclick="copiarParaExcel()">Copiar para Excel</button>
    </div>

    <script>
        function processarTexto() {
            const texto = document.getElementById('inputTexto').value;
            const linhas = texto.split('\n');
            let dados = [];
            
            // Processamento do texto
            linhas.forEach(linha => {
                let partes = linha.trim().split(":");
                if (partes.length > 1) {
                    let chave = partes[0].trim();
                    let valor = partes[1].trim();
                    dados.push({ chave, valor });
                }
            });

            // Preencher a tabela com os dados processados
            const tabelaCorpo = document.getElementById('tbodyTabela');
            tabelaCorpo.innerHTML = '';

            // Preenchendo as células com base nas chaves
            let tabelaLinha = '<tr>';
            dados.forEach(dado => {
                tabelaLinha += `<td>${dado.valor}</td>`;
            });
            tabelaLinha += '</tr>';

            tabelaCorpo.innerHTML = tabelaLinha;
        }

        // Função para copiar os dados em formato de planilha para o Excel
        function copiarParaExcel() {
            let tabela = document.getElementById("tabelaDados");
            let range = document.createRange();
            range.selectNode(tabela);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            alert("Tabela copiada! Agora você pode colar no Excel.");
        }
    </script>

    <!-- Link para o JS do Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
</body>
</html>
