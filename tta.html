<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gerador de Tabela</title>
    <style>
        .form-container {
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 300px;
            margin-bottom: 10px;
        }
        .result-table {
            margin: 20px;
            display: none;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button {
            margin: 5px;
            padding: 5px 10px;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <textarea id="inputText" placeholder="Cole aqui o texto no formato especificado"></textarea><br>
        <button onclick="generateTable()">Gerar Excel</button>
    </div>

    <div class="result-table" id="result">
        <button onclick="copyData()">Copiar Dados</button>
        <table id="resultTable">
            <thead>
                <tr>
                    <th>Nome da Empresa</th><th>Data</th><th>Hora</th>
                    <th>Origem</th><th>Destino</th><th>Local</th>
                    <th>Motorista</th><th>Telefone</th><th>Placa do Cavalo</th>
                    <th>Placa da Carreta</th><th>Motivo</th><th>Transportadora</th>
                    <th>Agente 1</th><th>Telefone do Agente 1</th><th>Veículo Utilizado</th><th>Placa</th>
                    <th>Agente 2</th><th>Telefone do Agente 2</th><th>Veículo Utilizado</th><th>Placa</th>
                    <th>Agente 3</th><th>Telefone do Agente 3</th><th>Veículo Utilizado</th><th>Placa</th>
                    <th>Valor do Pedágio</th><th>Km Inicial</th><th>Km Final</th><th>Total de Km</th>
                    <th>Horário Local do Agente</th><th>Horário de Início</th><th>Horário de Término</th>
                    <th>Total de Horas da Operação</th><th>Total de Horas do Agente</th><th>Manifesto</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <script>
        function generateTable() {
            const inputText = document.getElementById('inputText').value;
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            // Divide o texto em linhas
            const lines = inputText.split('\n');
            const data = {};
            let currentRow = [];

            // Campos esperados na ordem
            const fields = [
                'Nome da Empresa', 'Data', 'Hora',
                'Origem', 'Destino', 'Local',
                'Motorista', 'Telefone', 'Placa do Cavalo',
                'Placa da Carreta', 'Motivo', 'Transportadora',
                'Agente 1', 'Telefone do Agente 1', 'Veículo Utilizado', 'Placa',
                'Agente 2', 'Telefone do Agente 2', 'Veículo Utilizado', 'Placa',
                'Agente 3', 'Telefone do Agente 3', 'Veículo Utilizado', 'Placa',
                'Valor do Pedágio', 'Km Inicial', 'Km Final', 'Total de Km',
                'Horário Local do Agente', 'Horário de Início da Operação', 
                'Horário de Término da Operação', 'Total de Horas da Operação',
                'Total de Horas do Agente', 'Manifesto'
            ];

            // Processa cada linha
            lines.forEach(line => {
                const colonIndex = line.indexOf(':');
                if (colonIndex !== -1) {
                    const key = line.substring(0, colonIndex).trim();
                    const value = line.substring(colonIndex + 1).trim();
                    
                    if (key === 'Nome da Empresa' && Object.keys(data).length > 0) {
                        // Nova entrada, adiciona a anterior à tabela
                        addRowToTable(tableBody, data);
                        data = {};
                    }
                    
                    if (fields.includes(key)) {
                        data[key] = value;
                    }
                }
            });

            // Adiciona a última entrada
            if (Object.keys(data).length > 0) {
                addRowToTable(tableBody, data);
            }

            document.getElementById('result').style.display = 'block';
        }

        function addRowToTable(tableBody, data) {
            const row = document.createElement('tr');
            const fields = [
                'Nome da Empresa', 'Data', 'Hora',
                'Origem', 'Destino', 'Local',
                'Motorista', 'Telefone', 'Placa do Cavalo',
                'Placa da Carreta', 'Motivo', 'Transportadora',
                'Agente 1', 'Telefone do Agente 1', 'Veículo Utilizado', 'Placa',
                'Agente 2', 'Telefone do Agente 2', 'Veículo Utilizado', 'Placa',
                'Agente 3', 'Telefone do Agente 3', 'Veículo Utilizado', 'Placa',
                'Valor do Pedágio', 'Km Inicial', 'Km Final', 'Total de Km',
                'Horário Local do Agente', 'Horário de Início da Operação', 
                'Horário de Término da Operação', 'Total de Horas da Operação',
                'Total de Horas do Agente', 'Manifesto'
            ];

            fields.forEach(field => {
                const cell = document.createElement('td');
                cell.textContent = data[field] || '';
                row.appendChild(cell);
            });

            tableBody.appendChild(row);
        }

        function copyData() {
            const tableBody = document.getElementById('tableBody');
            const rows = tableBody.getElementsByTagName('tr');
            let text = '';
            
            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                let rowText = '';
                for (let cell of cells) {
                    rowText += cell.textContent + '\t';
                }
                text += rowText.trim() + '\n';
            }
            
            navigator.clipboard.writeText(text.trim())
                .then(() => alert('Dados copiados para a área de transferência!'))
                .catch(err => alert('Erro ao copiar: ' + err));
        }
    </script>
</body>
</html>
